- [4.2.1 广播事件](#421-广播事件)
  - [4.2.1.1 传统广播事件](#4211-传统广播事件)
  - [4.2.1.2 扩展广播事件](#4212-扩展广播事件)
  - [4.2.1.3 周期广播事件](#4213-周期广播事件)
- [4.2.2 广播事件类型](#422-广播事件类型)
- [4.2.3 广播PDU](#423-广播pdu)

众所周知，当我们在接触Bluetooth LE时，最先接触到的就是Bluetooth LE广播；自蓝牙规范v5.0开始，就对Bluetooth LE的广播特性做了大量地升级并新增了很多相关的特性，如扩展广播、周期广播、链式广播、广播集等；因此，本章内容将着重讲解Bluetooth LE的基础概念，如广播事件、广播PDUs、广播PHYs、广播间隔等等，让大家对Bluetooth LE广播有一个更加深入的了解。

# 4.2.1 广播事件
一般我们常见到的都是不同类型的广播包，但很少有人会提及什么是广播事件、广播事件与广播包又是什么关系？其实它是Bluetooth LE广播的重要组成部分；截止目前蓝牙规范v5.3，一共有如下3种广播事件：
- 传播广播事件
- 扩展广播事件
- 周期广播事件

接下来的子章节将给大家细述广播事件的具体内容。

## 4.2.1.1 传统广播事件
所谓传统广播事件（Advertising Event），指的是在广播通道 **（37，38，39）** 上发送的一个或多个广播 PDUs，而日常所说的广播包，其实就是由不同的广播事件组成；所以，它们之间的关系是**广播PDUs**-->**广播事件**-->**广播包**。

![](https://docdisk.wireless-tech.cn/img/2022/09/18/legacy_advertising_event_20220918174451381666.png)

从上图中，我们可以很清楚地看到该广播事件是由3个ADV_IND广播PDUs组成，而多个广播事件则组成了平时我们所看到的广播包，其中**两个广播事件之间的时间间隔叫广播间隔**。

## 4.2.1.2 扩展广播事件
扩展广播事件（Extended Advertising Event），指的是由在广播通道（37，38，39）上发送的一个或多个ADV_EXT_IND PDUs，以及在次级广播通道（0~36）上发送的子集PDUs组成。

![](https://docdisk.wireless-tech.cn/img/2022/09/18/extended_advertising_event_20220918223420260148.png)

跟传统广播事件不同的是，扩展广播事件除了在广播通道（37，38，39）发送PDUs，还在次级广播通道（0~36）上也发送PDUs。通过上图可知，该扩展广播事件由3个ADV_EXT_IND加上1个AUX_ADV_IND广播PDUs组成；但是，如果一个AUX_ADV_IND不足以放下剩余的广播PDUs，那么就会在AUX_ADV_IND后面接着发AUX_CHAIN_IND，直至所有的广播PDUs发送完成，才算扩展广播事件结束。

## 4.2.1.3 周期广播事件
周期广播事件（Periodic Advertising Event），指的是由在次级广播通道（0~36）上发送的AUX_SYNC_IND和其子集PDUs组成。

![](https://docdisk.wireless-tech.cn/img/2022/09/18/periodic_advertising_event_20220918225641637767.png)

由上图中，我们可以看出该周期广播事件开始于第一个AUX_SYNC_IND，而止于其子集的最后一个AUX_CHAIN_IND发送完成。

# 4.2.2 广播事件类型
我们或多或少都知道，有的Bluetooth LE广播是可以连接，而有的则无法与其建立连接；原因就在于Bluetooth LE广播是由多个广播事件组成的，而广播事件的类型又是多种多样的，从而组合成不同类型的Bluetooth LE广播；其中，不同类型的广播事件则由下述的不同类型组成：
- 可连接

  表示可以响应连接请求

- 不可连接

  表示不响应连接请求

- 可扫描

  表示可以响应扫描请求

- 不可扫描

  表示不响应扫描请求

- 定向

  表示只响应指定设备的请求

- 非定向

  表示可以响应任意设备的请求

而上述的这些类型，组合成不同类型的广播事件，如下：
- 可连接可扫描非定向广播事件
- 可连接不可扫描非定向广播事件
- 可连接不可扫描定向广播事件
  - 高占空比
  - 低占空比
- 不可连接不可扫描非定向广播事件
- 不可连接不可扫描定向广播事件
- 不可连接可扫描非定向广播事件
- 不可连接可扫描定向广播事件

截止蓝牙规范v5.3，上述的广播事件类型已经覆盖了所有的广播事件，包括周期广播、扩展广播和链式广播。


# 4.2.3 广播PDU
由上述的[4.2.1 广播事件](#421-广播事件)和[4.2.2 广播事件类型](#422-广播事件类型)可知，广播事件是由多个广播PDUs组成，但是不同类型的广播事件，其所对应的广播PDUs是不一样的。换句话说，有的广播PDUs仅适用于一部分的类型的广播事件，它们之间的关系如下：

![](https://docdisk.wireless-tech.cn/img/2022/09/21/advertising_event_vs_pdu_20220921234223129889.jpg)